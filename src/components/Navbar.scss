@use '../sass/breakpoints' as *;

// === NAVBAR =============================
.navbar {
    // internal variables
    --_gradient-deg: 180deg;          // degree of gradient border
    --_gradient-end: 250px;           // position of the var(--clr-300) point in the gradient border
    --_logo-size: 35px;
    --_link-width: 100%;              // width of the <a> that contain page icons
    --_link-height: 55px;             // height of the <a> that contain page icons
    --_icon-size: min(1.3rem, 40px); // width & height of <Navbar /> icons
    --_indicator-size: 12px;          // width and height of the small triangular indicator next to the magic line

    position: fixed;
    top: 0;
    bottom: 0;
    left: calc((100% - min(100%, var(--max-width))) / 2);
    z-index: 1000;
    
    width: var(--nav-size);

    overflow-y: auto;

    header {
        display: flex;
        flex-flow: column nowrap;
        justify-content: flex-end;
        position: relative;

        min-height: calc(100% - (2 * var(--pad-sm)));

        border: solid var(--border-width) transparent;
        border-radius: var(--bradius-sm) var(--bradius-xxl) var(--bradius-sm) var(--bradius-sm);
        margin: var(--pad-sm);

        // background color to cover ::before gradient to form border
        background: var(--clr-100);
        background-clip: padding-box;

        &::before {
            // background gradient clipped to create gradient border
            content: '';
            position: absolute;
            top: 0; right: 0; bottom: 0; left: 0;
            z-index: -1;
            margin: calc(-1 * var(--border-width));
            border-radius: inherit;
            background: linear-gradient(var(--_gradient-deg), var(--clr-rblue) 0px, var(--clr-300) var(--_gradient-end));
        }
        
        .logo {
            // 20px top padding and moved 1px to the left to appear more centered
            padding: var(--pad-xl)
                     calc((var(--_link-width) - var(--_logo-size)) / 2 + 1px)
                     calc(var(--pad-xl) / 2)
                     calc((var(--_link-width) - var(--_logo-size)) / 2 - 1px);

            &__path {
                fill: var(--clr-rblue);
            }
        }

        nav {
            // add slight padding to top and bottom of <ul>
            padding: calc(var(--_link-width) - var(--_link-height)) 0;
            margin-top: auto;
            

            ul {
                display: flex;
                flex-flow: column nowrap;
                position: relative;
            }

            a {
                display: flex;
                align-items: center;
                justify-content: center;

                width: var(--_link-width);
                height: var(--_link-height);
                
                transition: transform var(--trans-standard);

                &.active, &:hover, &:focus {
                    .stroke--md {
                        // change page icon stroke color
                        stroke: var(--clr-1000);
                    }
                }

                &:focus-visible {
                    outline: solid var(--outline-width) var(--clr-focus);
                    border-radius: var(--bradius-xxs);
                }

                &:active {
                    transform: var(--active-translateY-md);
                }

                svg {
                    width: var(--_icon-size);
                }
            }

            .magicLine {
                // styling that applies to both #magicLineVrt and #magicLineHrz
                position: absolute;

                // transition on transform change (set through JS)
                transition: transform var(--transTime-slowest) var(--transFunc-enhancedEase);

                &::before {
                    content: "";
                    position: absolute;

                    width: var(--_indicator-size);
                    height: var(--_indicator-size);

                    background-color: #fff;
                    // 1px border to avoid clipping AA bug on Firefox
                    border: solid 1px var(--clr-100);
                }
            }

            #magicLineVrt {
                top: 0;
                right: calc(-1 * var(--border-width));

                width: var(--border-width);
                height: var(--_link-height);

                background: linear-gradient(180deg, var(--clr-1000-trans) 0%, var(--clr-1000) 30%, var(--clr-1000) 70%, var(--clr-1000-trans) 100%);
            
                &::before {
                    // top margin to vertically center ::before
                    top: calc((var(--_link-height) - var(--_indicator-size)) / 2);
                    // slight shift right to avoid AA issues
                    right: calc(-1 * (var(--_indicator-size) / 2) + var(--border-width)); 

                    border-top-left-radius: var(--bradius-xxs);

                    // rotate square to become a rhombus
                    transform: rotate(-45deg);
                    // clip rhombus to become a triangle
                    clip-path: polygon(0 0, 0% 100%, 100% 0);
                }
            }

            #magicLineHrz {
                // hide horizontal magic line when showing vertical <NavBar /> layout
                display: none;
            }
        }
    }
}



// === BREAKPOINTS ============================
@media (orientation: portrait) {
    .navbar {
        // internal variables
        --_gradient-deg: 90deg;          // degree of gradient border
        --_gradient-end: 150px;           // position of the var(--clr-300) point in the gradient border
        --_link-width: 55px;              // width of the <a> that contain page icons
        --_link-height: 100%;             // height of the <a> that contain page icons

        // new absolute insets to move <Navbar> to the bottom
        top: unset;
        right: 0;
        bottom: 0;
        left: 0;
        
        width: unset;
        max-width: var(--max-width);
        height: calc(var(--nav-size) - var(--pad-sm));

        margin-right: auto;
        margin-left: auto;

        // background color to block all elements below
        background-color: var(--clr-100);
        box-shadow: 0px 0px 17px 3px var(--clr-100);

        // remove y auto overflow and add x overflow
        overflow-x: auto;
        overflow-y: hidden;

        header {
            flex-flow: row nowrap;
            justify-content: flex-start;
            align-items: center;
            position: relative;
    
            min-width: calc(100% - (2 * var(--pad-sm)));
            min-height: unset;
            width: fit-content;
            height: calc(100% - var(--pad-sm));
    
            border-radius: var(--bradius-sm) var(--bradius-sm) var(--bradius-sm) var(--bradius-xxl);
            margin: 0 var(--pad-sm) var(--pad-sm) var(--pad-sm);
            
            .logo {
                flex-shrink: 0;
                // 20px top padding and moved 1px to the left to appear more centered
                padding: 0 0 0 var(--pad-xl);
                // padding: 0;
                width: calc((0.94 * var(--_logo-size)) + var(--pad-xl));
                height: 100%;
            }
    
            nav {
                height: 100%;
                // add slight padding to top and bottom of <ul>
                padding: 0 var(--pad-md);
                margin-top: 0;
                margin-left: auto;
                
    
                ul {
                    flex-flow: row nowrap;

                    height: 100%;
                }
    
                #magicLineVrt {
                    // hide vertical magic line
                    display: none;
                }
    
                #magicLineHrz {
                    display: block;
                    top: calc(-1 * var(--border-width));
                    left: calc(-1 * var(--pad-xs));
    
                    width: calc(var(--_link-width) + (2 * var(--pad-xs)));
                    height: var(--border-width);
    
                    background: linear-gradient(90deg, var(--clr-1000-trans) 0%, var(--clr-1000) 30%, var(--clr-1000) 70%, var(--clr-1000-trans) 100%);
                
                    &::before {
                        // slight shift down to avoid AA issues
                        top: calc(-1 * (var(--_indicator-size) / 2) + var(--border-width)); 
                        // left margin to horizontally center ::before
                        left: calc((var(--_link-width) + (2 * var(--pad-xs)) - var(--_indicator-size)) / 2);
                        
    
                        border-bottom-left-radius: var(--bradius-xxs);
    
                        // rotate square to become a rhombus
                        transform: rotate(-45deg);
                        // clip rhombus to become a triangle
                        clip-path: polygon(0 0, 0% 100%, 100% 100%);
                    }
                }
            }
        }
    }
}

@media only screen and (max-width: $breakpoint-mobile) {
    .navbar {
        // internal variables
        --_logo-size: 30px;
        --_icon-size: min(1.3rem, 40px); // width & height of <Navbar /> icons
        --_indicator-size: 12px;          // width and height of the small triangular indicator next to the magic line
    }
}